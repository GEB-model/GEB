"""Adapter for ESA WorldCover datasets using direct AWS S3 access."""

from __future__ import annotations

import math
from typing import Any

import rasterio
import rioxarray  # noqa: F401 – registers .rio accessor on xarray
import xarray as xr
from rioxarray.merge import merge_arrays

from .base import Adapter

_S3_BUCKET = "esa-worldcover"
_S3_REGION = "eu-central-1"  # AWS datacenter where the bucket is hosted; data covers the entire globe
_S3_TILE_PATH = "v200/2021/map"
_TILE_SIZE_DEG = 3

AVAILABLE_TILES: set[str] = {
    "N00E006",
    "N00E009",
    "N00E012",
    "N00E015",
    "N00E018",
    "N00E021",
    "N00E024",
    "N00E027",
    "N00E030",
    "N00E033",
    "N00E036",
    "N00E039",
    "N00E042",
    "N00E045",
    "N00E072",
    "N00E093",
    "N00E096",
    "N00E099",
    "N00E102",
    "N00E105",
    "N00E108",
    "N00E111",
    "N00E114",
    "N00E117",
    "N00E120",
    "N00E123",
    "N00E126",
    "N00E129",
    "N00E132",
    "N00E171",
    "N00W051",
    "N00W054",
    "N00W057",
    "N00W060",
    "N00W063",
    "N00W066",
    "N00W069",
    "N00W072",
    "N00W075",
    "N00W078",
    "N00W081",
    "N00W090",
    "N00W093",
    "N00W159",
    "N03E000",
    "N03E003",
    "N03E006",
    "N03E009",
    "N03E012",
    "N03E015",
    "N03E018",
    "N03E021",
    "N03E024",
    "N03E027",
    "N03E030",
    "N03E033",
    "N03E036",
    "N03E039",
    "N03E042",
    "N03E045",
    "N03E048",
    "N03E072",
    "N03E078",
    "N03E093",
    "N03E096",
    "N03E099",
    "N03E102",
    "N03E105",
    "N03E108",
    "N03E111",
    "N03E114",
    "N03E117",
    "N03E120",
    "N03E123",
    "N03E126",
    "N03E156",
    "N03E162",
    "N03E168",
    "N03E171",
    "N03W003",
    "N03W006",
    "N03W009",
    "N03W012",
    "N03W051",
    "N03W054",
    "N03W057",
    "N03W060",
    "N03W063",
    "N03W066",
    "N03W069",
    "N03W072",
    "N03W075",
    "N03W078",
    "N03W081",
    "N03W165",
    "N06E000",
    "N06E003",
    "N06E006",
    "N06E009",
    "N06E012",
    "N06E015",
    "N06E018",
    "N06E021",
    "N06E024",
    "N06E027",
    "N06E030",
    "N06E033",
    "N06E036",
    "N06E039",
    "N06E042",
    "N06E045",
    "N06E048",
    "N06E072",
    "N06E075",
    "N06E078",
    "N06E081",
    "N06E090",
    "N06E093",
    "N06E096",
    "N06E099",
    "N06E102",
    "N06E105",
    "N06E111",
    "N06E114",
    "N06E117",
    "N06E120",
    "N06E123",
    "N06E126",
    "N06E132",
    "N06E156",
    "N06E159",
    "N06E165",
    "N06E168",
    "N06E171",
    "N06W003",
    "N06W006",
    "N06W009",
    "N06W012",
    "N06W015",
    "N06W057",
    "N06W060",
    "N06W063",
    "N06W066",
    "N06W069",
    "N06W072",
    "N06W075",
    "N06W078",
    "N06W081",
    "N06W084",
    "N09E000",
    "N09E003",
    "N09E006",
    "N09E009",
    "N09E012",
    "N09E015",
    "N09E018",
    "N09E021",
    "N09E024",
    "N09E027",
    "N09E030",
    "N09E033",
    "N09E036",
    "N09E039",
    "N09E042",
    "N09E045",
    "N09E048",
    "N09E051",
    "N09E072",
    "N09E075",
    "N09E078",
    "N09E081",
    "N09E090",
    "N09E093",
    "N09E096",
    "N09E099",
    "N09E102",
    "N09E105",
    "N09E108",
    "N09E111",
    "N09E114",
    "N09E117",
    "N09E120",
    "N09E123",
    "N09E126",
    "N09E138",
    "N09E159",
    "N09E162",
    "N09E165",
    "N09E168",
    "N09W003",
    "N09W006",
    "N09W009",
    "N09W012",
    "N09W015",
    "N09W018",
    "N09W063",
    "N09W066",
    "N09W069",
    "N09W072",
    "N09W075",
    "N09W078",
    "N09W081",
    "N09W084",
    "N09W087",
    "N09W111",
    "N12E000",
    "N12E003",
    "N12E006",
    "N12E009",
    "N12E012",
    "N12E015",
    "N12E018",
    "N12E021",
    "N12E024",
    "N12E027",
    "N12E030",
    "N12E033",
    "N12E036",
    "N12E039",
    "N12E042",
    "N12E045",
    "N12E048",
    "N12E051",
    "N12E054",
    "N12E072",
    "N12E075",
    "N12E078",
    "N12E090",
    "N12E093",
    "N12E096",
    "N12E099",
    "N12E102",
    "N12E105",
    "N12E108",
    "N12E117",
    "N12E120",
    "N12E123",
    "N12E144",
    "N12E168",
    "N12W003",
    "N12W006",
    "N12W009",
    "N12W012",
    "N12W015",
    "N12W018",
    "N12W024",
    "N12W027",
    "N12W060",
    "N12W063",
    "N12W069",
    "N12W072",
    "N12W075",
    "N12W081",
    "N12W084",
    "N12W087",
    "N12W090",
    "N12W093",
    "N15E000",
    "N15E003",
    "N15E006",
    "N15E009",
    "N15E012",
    "N15E015",
    "N15E018",
    "N15E021",
    "N15E024",
    "N15E027",
    "N15E030",
    "N15E033",
    "N15E036",
    "N15E039",
    "N15E042",
    "N15E045",
    "N15E048",
    "N15E051",
    "N15E054",
    "N15E072",
    "N15E075",
    "N15E078",
    "N15E081",
    "N15E093",
    "N15E096",
    "N15E099",
    "N15E102",
    "N15E105",
    "N15E108",
    "N15E111",
    "N15E117",
    "N15E120",
    "N15E144",
    "N15W003",
    "N15W006",
    "N15W009",
    "N15W012",
    "N15W015",
    "N15W018",
    "N15W024",
    "N15W027",
    "N15W063",
    "N15W066",
    "N15W069",
    "N15W072",
    "N15W075",
    "N15W078",
    "N15W081",
    "N15W084",
    "N15W087",
    "N15W090",
    "N15W093",
    "N15W096",
    "N15W099",
    "N15W102",
    "N15W105",
    "N18E000",
    "N18E003",
    "N18E006",
    "N18E009",
    "N18E012",
    "N18E015",
    "N18E018",
    "N18E021",
    "N18E024",
    "N18E027",
    "N18E030",
    "N18E033",
    "N18E036",
    "N18E039",
    "N18E042",
    "N18E045",
    "N18E048",
    "N18E051",
    "N18E054",
    "N18E057",
    "N18E069",
    "N18E072",
    "N18E075",
    "N18E078",
    "N18E081",
    "N18E084",
    "N18E087",
    "N18E090",
    "N18E093",
    "N18E096",
    "N18E099",
    "N18E102",
    "N18E105",
    "N18E108",
    "N18E111",
    "N18E114",
    "N18E120",
    "N18W003",
    "N18W006",
    "N18W009",
    "N18W012",
    "N18W015",
    "N18W018",
    "N18W063",
    "N18W066",
    "N18W069",
    "N18W072",
    "N18W075",
    "N18W078",
    "N18W081",
    "N18W084",
    "N18W087",
    "N18W090",
    "N18W093",
    "N18W096",
    "N18W099",
    "N18W102",
    "N18W105",
    "N18W108",
    "N18W111",
    "N18W114",
    "N18W156",
    "N18W159",
    "N21E000",
    "N21E003",
    "N21E006",
    "N21E009",
    "N21E012",
    "N21E015",
    "N21E018",
    "N21E021",
    "N21E024",
    "N21E027",
    "N21E030",
    "N21E033",
    "N21E036",
    "N21E039",
    "N21E042",
    "N21E045",
    "N21E048",
    "N21E051",
    "N21E054",
    "N21E057",
    "N21E066",
    "N21E069",
    "N21E072",
    "N21E075",
    "N21E078",
    "N21E081",
    "N21E084",
    "N21E087",
    "N21E090",
    "N21E093",
    "N21E096",
    "N21E099",
    "N21E102",
    "N21E105",
    "N21E108",
    "N21E111",
    "N21E114",
    "N21E117",
    "N21E120",
    "N21E123",
    "N21W003",
    "N21W006",
    "N21W009",
    "N21W012",
    "N21W015",
    "N21W018",
    "N21W072",
    "N21W075",
    "N21W078",
    "N21W081",
    "N21W084",
    "N21W087",
    "N21W090",
    "N21W093",
    "N21W099",
    "N21W102",
    "N21W105",
    "N21W108",
    "N21W111",
    "N21W114",
    "N21W159",
    "N21W162",
    "N24E000",
    "N24E003",
    "N24E006",
    "N24E009",
    "N24E012",
    "N24E015",
    "N24E018",
    "N24E021",
    "N24E024",
    "N24E027",
    "N24E030",
    "N24E033",
    "N24E036",
    "N24E039",
    "N24E042",
    "N24E045",
    "N24E048",
    "N24E051",
    "N24E054",
    "N24E057",
    "N24E060",
    "N24E063",
    "N24E066",
    "N24E069",
    "N24E072",
    "N24E075",
    "N24E078",
    "N24E081",
    "N24E084",
    "N24E087",
    "N24E090",
    "N24E093",
    "N24E096",
    "N24E099",
    "N24E102",
    "N24E105",
    "N24E108",
    "N24E111",
    "N24E114",
    "N24E117",
    "N24E120",
    "N24E123",
    "N24E126",
    "N24E129",
    "N24W003",
    "N24W006",
    "N24W009",
    "N24W012",
    "N24W015",
    "N24W018",
    "N24W075",
    "N24W078",
    "N24W081",
    "N24W084",
    "N24W099",
    "N24W102",
    "N24W105",
    "N24W108",
    "N24W111",
    "N24W114",
    "N24W117",
    "N27E000",
    "N27E003",
    "N27E006",
    "N27E009",
    "N27E012",
    "N27E015",
    "N27E018",
    "N27E021",
    "N27E024",
    "N27E027",
    "N27E030",
    "N27E033",
    "N27E036",
    "N27E039",
    "N27E042",
    "N27E045",
    "N27E048",
    "N27E051",
    "N27E054",
    "N27E057",
    "N27E060",
    "N27E063",
    "N27E066",
    "N27E069",
    "N27E072",
    "N27E075",
    "N27E078",
    "N27E081",
    "N27E084",
    "N27E087",
    "N27E090",
    "N27E093",
    "N27E096",
    "N27E099",
    "N27E102",
    "N27E105",
    "N27E108",
    "N27E111",
    "N27E114",
    "N27E117",
    "N27E120",
    "N27E126",
    "N27E129",
    "N27W003",
    "N27W006",
    "N27W009",
    "N27W012",
    "N27W015",
    "N27W018",
    "N27W021",
    "N27W078",
    "N27W081",
    "N27W084",
    "N27W087",
    "N27W090",
    "N27W093",
    "N27W096",
    "N27W099",
    "N27W102",
    "N27W105",
    "N27W108",
    "N27W111",
    "N27W114",
    "N27W117",
    "N27W120",
    "N30E000",
    "N30E003",
    "N30E006",
    "N30E009",
    "N30E012",
    "N30E015",
    "N30E018",
    "N30E021",
    "N30E024",
    "N30E027",
    "N30E030",
    "N30E033",
    "N30E036",
    "N30E039",
    "N30E042",
    "N30E045",
    "N30E048",
    "N30E051",
    "N30E054",
    "N30E057",
    "N30E060",
    "N30E063",
    "N30E066",
    "N30E069",
    "N30E072",
    "N30E075",
    "N30E078",
    "N30E081",
    "N30E084",
    "N30E087",
    "N30E090",
    "N30E093",
    "N30E096",
    "N30E099",
    "N30E102",
    "N30E105",
    "N30E108",
    "N30E111",
    "N30E114",
    "N30E117",
    "N30E120",
    "N30E123",
    "N30E126",
    "N30E129",
    "N30E132",
    "N30E138",
    "N30W003",
    "N30W006",
    "N30W009",
    "N30W012",
    "N30W018",
    "N30W066",
    "N30W081",
    "N30W084",
    "N30W087",
    "N30W090",
    "N30W093",
    "N30W096",
    "N30W099",
    "N30W102",
    "N30W105",
    "N30W108",
    "N30W111",
    "N30W114",
    "N30W117",
    "N30W120",
    "N33E000",
    "N33E003",
    "N33E006",
    "N33E009",
    "N33E012",
    "N33E021",
    "N33E024",
    "N33E027",
    "N33E030",
    "N33E033",
    "N33E036",
    "N33E039",
    "N33E042",
    "N33E045",
    "N33E048",
    "N33E051",
    "N33E054",
    "N33E057",
    "N33E060",
    "N33E063",
    "N33E066",
    "N33E069",
    "N33E072",
    "N33E075",
    "N33E078",
    "N33E081",
    "N33E084",
    "N33E087",
    "N33E090",
    "N33E093",
    "N33E096",
    "N33E099",
    "N33E102",
    "N33E105",
    "N33E108",
    "N33E111",
    "N33E114",
    "N33E117",
    "N33E120",
    "N33E123",
    "N33E126",
    "N33E129",
    "N33E132",
    "N33E135",
    "N33E138",
    "N33W003",
    "N33W006",
    "N33W009",
    "N33W018",
    "N33W078",
    "N33W081",
    "N33W084",
    "N33W087",
    "N33W090",
    "N33W093",
    "N33W096",
    "N33W099",
    "N33W102",
    "N33W105",
    "N33W108",
    "N33W111",
    "N33W114",
    "N33W117",
    "N33W120",
    "N33W123",
    "N36E000",
    "N36E003",
    "N36E006",
    "N36E009",
    "N36E012",
    "N36E015",
    "N36E018",
    "N36E021",
    "N36E024",
    "N36E027",
    "N36E030",
    "N36E033",
    "N36E036",
    "N36E039",
    "N36E042",
    "N36E045",
    "N36E048",
    "N36E051",
    "N36E054",
    "N36E057",
    "N36E060",
    "N36E063",
    "N36E066",
    "N36E069",
    "N36E072",
    "N36E075",
    "N36E078",
    "N36E081",
    "N36E084",
    "N36E087",
    "N36E090",
    "N36E093",
    "N36E096",
    "N36E099",
    "N36E102",
    "N36E105",
    "N36E108",
    "N36E111",
    "N36E114",
    "N36E117",
    "N36E120",
    "N36E123",
    "N36E126",
    "N36E129",
    "N36E132",
    "N36E135",
    "N36E138",
    "N36E141",
    "N36W003",
    "N36W006",
    "N36W009",
    "N36W012",
    "N36W027",
    "N36W030",
    "N36W075",
    "N36W078",
    "N36W081",
    "N36W084",
    "N36W087",
    "N36W090",
    "N36W093",
    "N36W096",
    "N36W099",
    "N36W102",
    "N36W105",
    "N36W108",
    "N36W111",
    "N36W114",
    "N36W117",
    "N36W120",
    "N36W123",
    "N36W126",
    "N39E000",
    "N39E003",
    "N39E006",
    "N39E009",
    "N39E012",
    "N39E015",
    "N39E018",
    "N39E021",
    "N39E024",
    "N39E027",
    "N39E030",
    "N39E033",
    "N39E036",
    "N39E039",
    "N39E042",
    "N39E045",
    "N39E048",
    "N39E051",
    "N39E054",
    "N39E057",
    "N39E060",
    "N39E063",
    "N39E066",
    "N39E069",
    "N39E072",
    "N39E075",
    "N39E078",
    "N39E081",
    "N39E084",
    "N39E087",
    "N39E090",
    "N39E093",
    "N39E096",
    "N39E099",
    "N39E102",
    "N39E105",
    "N39E108",
    "N39E111",
    "N39E114",
    "N39E117",
    "N39E120",
    "N39E123",
    "N39E126",
    "N39E129",
    "N39E138",
    "N39E141",
    "N39W003",
    "N39W006",
    "N39W009",
    "N39W012",
    "N39W030",
    "N39W033",
    "N39W072",
    "N39W075",
    "N39W078",
    "N39W081",
    "N39W084",
    "N39W087",
    "N39W090",
    "N39W093",
    "N39W096",
    "N39W099",
    "N39W102",
    "N39W105",
    "N39W108",
    "N39W111",
    "N39W114",
    "N39W117",
    "N39W120",
    "N39W123",
    "N39W126",
    "N42E000",
    "N42E003",
    "N42E006",
    "N42E009",
    "N42E012",
    "N42E015",
    "N42E018",
    "N42E021",
    "N42E024",
    "N42E027",
    "N42E033",
    "N42E036",
    "N42E039",
    "N42E042",
    "N42E045",
    "N42E048",
    "N42E051",
    "N42E054",
    "N42E057",
    "N42E060",
    "N42E063",
    "N42E066",
    "N42E069",
    "N42E072",
    "N42E075",
    "N42E078",
    "N42E081",
    "N42E084",
    "N42E087",
    "N42E090",
    "N42E093",
    "N42E096",
    "N42E099",
    "N42E102",
    "N42E105",
    "N42E108",
    "N42E111",
    "N42E114",
    "N42E117",
    "N42E120",
    "N42E123",
    "N42E126",
    "N42E129",
    "N42E132",
    "N42E135",
    "N42E138",
    "N42E141",
    "N42E144",
    "N42E147",
    "N42W003",
    "N42W006",
    "N42W009",
    "N42W012",
    "N42W060",
    "N42W063",
    "N42W066",
    "N42W069",
    "N42W072",
    "N42W075",
    "N42W078",
    "N42W081",
    "N42W084",
    "N42W087",
    "N42W090",
    "N42W093",
    "N42W096",
    "N42W099",
    "N42W102",
    "N42W105",
    "N42W108",
    "N42W111",
    "N42W114",
    "N42W117",
    "N42W120",
    "N42W123",
    "N42W126",
    "N45E000",
    "N45E003",
    "N45E006",
    "N45E009",
    "N45E012",
    "N45E015",
    "N45E018",
    "N45E021",
    "N45E024",
    "N45E027",
    "N45E030",
    "N45E033",
    "N45E036",
    "N45E039",
    "N45E042",
    "N45E045",
    "N45E048",
    "N45E051",
    "N45E054",
    "N45E057",
    "N45E060",
    "N45E063",
    "N45E066",
    "N45E069",
    "N45E072",
    "N45E075",
    "N45E078",
    "N45E081",
    "N45E084",
    "N45E087",
    "N45E090",
    "N45E093",
    "N45E096",
    "N45E099",
    "N45E102",
    "N45E105",
    "N45E108",
    "N45E111",
    "N45E114",
    "N45E117",
    "N45E120",
    "N45E123",
    "N45E126",
    "N45E129",
    "N45E132",
    "N45E135",
    "N45E138",
    "N45E141",
    "N45E147",
    "N45E150",
    "N45E153",
    "N45W003",
    "N45W006",
    "N45W054",
    "N45W057",
    "N45W060",
    "N45W063",
    "N45W066",
    "N45W069",
    "N45W072",
    "N45W075",
    "N45W078",
    "N45W081",
    "N45W084",
    "N45W087",
    "N45W090",
    "N45W093",
    "N45W096",
    "N45W099",
    "N45W102",
    "N45W105",
    "N45W108",
    "N45W111",
    "N45W114",
    "N45W117",
    "N45W120",
    "N45W123",
    "N45W126",
    "N48E000",
    "N48E003",
    "N48E006",
    "N48E009",
    "N48E012",
    "N48E015",
    "N48E018",
    "N48E021",
    "N48E024",
    "N48E027",
    "N48E030",
    "N48E033",
    "N48E036",
    "N48E039",
    "N48E042",
    "N48E045",
    "N48E048",
    "N48E051",
    "N48E054",
    "N48E057",
    "N48E060",
    "N48E063",
    "N48E066",
    "N48E069",
    "N48E072",
    "N48E075",
    "N48E078",
    "N48E081",
    "N48E084",
    "N48E087",
    "N48E090",
    "N48E093",
    "N48E096",
    "N48E099",
    "N48E102",
    "N48E105",
    "N48E108",
    "N48E111",
    "N48E114",
    "N48E117",
    "N48E120",
    "N48E123",
    "N48E126",
    "N48E129",
    "N48E132",
    "N48E135",
    "N48E138",
    "N48E141",
    "N48E144",
    "N48E153",
    "N48E156",
    "N48W003",
    "N48W006",
    "N48W009",
    "N48W054",
    "N48W057",
    "N48W060",
    "N48W063",
    "N48W066",
    "N48W069",
    "N48W072",
    "N48W075",
    "N48W078",
    "N48W081",
    "N48W084",
    "N48W087",
    "N48W090",
    "N48W093",
    "N48W096",
    "N48W099",
    "N48W102",
    "N48W105",
    "N48W108",
    "N48W111",
    "N48W114",
    "N48W117",
    "N48W120",
    "N48W123",
    "N48W126",
    "N48W129",
    "N48W132",
    "N51E000",
    "N51E003",
    "N51E006",
    "N51E009",
    "N51E012",
    "N51E015",
    "N51E018",
    "N51E021",
    "N51E024",
    "N51E027",
    "N51E030",
    "N51E033",
    "N51E036",
    "N51E039",
    "N51E042",
    "N51E045",
    "N51E048",
    "N51E051",
    "N51E054",
    "N51E057",
    "N51E060",
    "N51E063",
    "N51E066",
    "N51E069",
    "N51E072",
    "N51E075",
    "N51E078",
    "N51E081",
    "N51E084",
    "N51E087",
    "N51E090",
    "N51E093",
    "N51E096",
    "N51E099",
    "N51E102",
    "N51E105",
    "N51E108",
    "N51E111",
    "N51E114",
    "N51E117",
    "N51E120",
    "N51E123",
    "N51E126",
    "N51E129",
    "N51E132",
    "N51E135",
    "N51E138",
    "N51E141",
    "N51E153",
    "N51E156",
    "N51E159",
    "N51E171",
    "N51E174",
    "N51E177",
    "N51W003",
    "N51W006",
    "N51W009",
    "N51W012",
    "N51W057",
    "N51W060",
    "N51W063",
    "N51W066",
    "N51W069",
    "N51W072",
    "N51W075",
    "N51W078",
    "N51W081",
    "N51W084",
    "N51W087",
    "N51W090",
    "N51W093",
    "N51W096",
    "N51W099",
    "N51W102",
    "N51W105",
    "N51W108",
    "N51W111",
    "N51W114",
    "N51W117",
    "N51W120",
    "N51W123",
    "N51W126",
    "N51W129",
    "N51W132",
    "N51W135",
    "N51W168",
    "N51W171",
    "N51W174",
    "N51W177",
    "N51W180",
    "N54E006",
    "N54E009",
    "N54E012",
    "N54E015",
    "N54E018",
    "N54E021",
    "N54E024",
    "N54E027",
    "N54E030",
    "N54E033",
    "N54E036",
    "N54E039",
    "N54E042",
    "N54E045",
    "N54E048",
    "N54E051",
    "N54E054",
    "N54E057",
    "N54E060",
    "N54E063",
    "N54E066",
    "N54E069",
    "N54E072",
    "N54E075",
    "N54E078",
    "N54E081",
    "N54E084",
    "N54E087",
    "N54E090",
    "N54E093",
    "N54E096",
    "N54E099",
    "N54E102",
    "N54E105",
    "N54E108",
    "N54E111",
    "N54E114",
    "N54E117",
    "N54E120",
    "N54E123",
    "N54E126",
    "N54E129",
    "N54E132",
    "N54E135",
    "N54E138",
    "N54E141",
    "N54E153",
    "N54E156",
    "N54E159",
    "N54E162",
    "N54E165",
    "N54E168",
    "N54W003",
    "N54W006",
    "N54W009",
    "N54W012",
    "N54W057",
    "N54W060",
    "N54W063",
    "N54W066",
    "N54W069",
    "N54W072",
    "N54W075",
    "N54W078",
    "N54W081",
    "N54W084",
    "N54W087",
    "N54W090",
    "N54W093",
    "N54W096",
    "N54W099",
    "N54W102",
    "N54W105",
    "N54W108",
    "N54W111",
    "N54W114",
    "N54W117",
    "N54W120",
    "N54W123",
    "N54W126",
    "N54W129",
    "N54W132",
    "N54W135",
    "N54W138",
    "N54W156",
    "N54W159",
    "N54W162",
    "N54W165",
    "N54W168",
    "N54W171",
    "N57E003",
    "N57E006",
    "N57E009",
    "N57E012",
    "N57E015",
    "N57E018",
    "N57E021",
    "N57E024",
    "N57E027",
    "N57E030",
    "N57E033",
    "N57E036",
    "N57E039",
    "N57E042",
    "N57E045",
    "N57E048",
    "N57E051",
    "N57E054",
    "N57E057",
    "N57E060",
    "N57E063",
    "N57E066",
    "N57E069",
    "N57E072",
    "N57E075",
    "N57E078",
    "N57E081",
    "N57E084",
    "N57E087",
    "N57E090",
    "N57E093",
    "N57E096",
    "N57E099",
    "N57E102",
    "N57E105",
    "N57E108",
    "N57E111",
    "N57E114",
    "N57E117",
    "N57E120",
    "N57E123",
    "N57E126",
    "N57E129",
    "N57E132",
    "N57E135",
    "N57E138",
    "N57E141",
    "N57E144",
    "N57E147",
    "N57E150",
    "N57E153",
    "N57E156",
    "N57E159",
    "N57E162",
    "N57E165",
    "N57E168",
    "N57W003",
    "N57W006",
    "N57W009",
    "N57W015",
    "N57W045",
    "N57W048",
    "N57W063",
    "N57W066",
    "N57W069",
    "N57W072",
    "N57W075",
    "N57W078",
    "N57W081",
    "N57W090",
    "N57W093",
    "N57W096",
    "N57W099",
    "N57W102",
    "N57W105",
    "N57W108",
    "N57W111",
    "N57W114",
    "N57W117",
    "N57W120",
    "N57W123",
    "N57W126",
    "N57W129",
    "N57W132",
    "N57W135",
    "N57W138",
    "N57W141",
    "N57W144",
    "N57W147",
    "N57W150",
    "N57W153",
    "N57W156",
    "N57W159",
    "N57W162",
    "N57W165",
    "N57W168",
    "N57W171",
    "N60E003",
    "N60E006",
    "N60E009",
    "N60E012",
    "N60E015",
    "N60E018",
    "N60E021",
    "N60E024",
    "N60E027",
    "N60E030",
    "N60E033",
    "N60E036",
    "N60E039",
    "N60E042",
    "N60E045",
    "N60E048",
    "N60E051",
    "N60E054",
    "N60E057",
    "N60E060",
    "N60E063",
    "N60E066",
    "N60E069",
    "N60E072",
    "N60E075",
    "N60E078",
    "N60E081",
    "N60E084",
    "N60E087",
    "N60E090",
    "N60E093",
    "N60E096",
    "N60E099",
    "N60E102",
    "N60E105",
    "N60E108",
    "N60E111",
    "N60E114",
    "N60E117",
    "N60E120",
    "N60E123",
    "N60E126",
    "N60E129",
    "N60E132",
    "N60E135",
    "N60E138",
    "N60E141",
    "N60E144",
    "N60E147",
    "N60E150",
    "N60E153",
    "N60E156",
    "N60E159",
    "N60E162",
    "N60E165",
    "N60E168",
    "N60E171",
    "N60E174",
    "N60E177",
    "N60W003",
    "N60W009",
    "N60W042",
    "N60W045",
    "N60W048",
    "N60W051",
    "N60W054",
    "N60W066",
    "N60W069",
    "N60W072",
    "N60W075",
    "N60W078",
    "N60W081",
    "N60W084",
    "N60W087",
    "N60W093",
    "N60W096",
    "N60W099",
    "N60W102",
    "N60W105",
    "N60W108",
    "N60W111",
    "N60W114",
    "N60W117",
    "N60W120",
    "N60W123",
    "N60W126",
    "N60W129",
    "N60W132",
    "N60W135",
    "N60W138",
    "N60W141",
    "N60W144",
    "N60W147",
    "N60W150",
    "N60W153",
    "N60W156",
    "N60W159",
    "N60W162",
    "N60W165",
    "N60W168",
    "N60W171",
    "N60W174",
    "N63E006",
    "N63E009",
    "N63E012",
    "N63E015",
    "N63E018",
    "N63E021",
    "N63E024",
    "N63E027",
    "N63E030",
    "N63E033",
    "N63E036",
    "N63E039",
    "N63E042",
    "N63E045",
    "N63E048",
    "N63E051",
    "N63E054",
    "N63E057",
    "N63E060",
    "N63E063",
    "N63E066",
    "N63E069",
    "N63E072",
    "N63E075",
    "N63E078",
    "N63E081",
    "N63E084",
    "N63E087",
    "N63E090",
    "N63E093",
    "N63E096",
    "N63E099",
    "N63E102",
    "N63E105",
    "N63E108",
    "N63E111",
    "N63E114",
    "N63E117",
    "N63E120",
    "N63E123",
    "N63E126",
    "N63E129",
    "N63E132",
    "N63E135",
    "N63E138",
    "N63E141",
    "N63E144",
    "N63E147",
    "N63E150",
    "N63E153",
    "N63E156",
    "N63E159",
    "N63E162",
    "N63E165",
    "N63E168",
    "N63E171",
    "N63E174",
    "N63E177",
    "N63W015",
    "N63W018",
    "N63W021",
    "N63W024",
    "N63W027",
    "N63W036",
    "N63W039",
    "N63W042",
    "N63W045",
    "N63W048",
    "N63W051",
    "N63W054",
    "N63W063",
    "N63W066",
    "N63W069",
    "N63W072",
    "N63W075",
    "N63W078",
    "N63W081",
    "N63W084",
    "N63W087",
    "N63W090",
    "N63W093",
    "N63W096",
    "N63W099",
    "N63W102",
    "N63W105",
    "N63W108",
    "N63W111",
    "N63W114",
    "N63W117",
    "N63W120",
    "N63W123",
    "N63W126",
    "N63W129",
    "N63W132",
    "N63W135",
    "N63W138",
    "N63W141",
    "N63W144",
    "N63W147",
    "N63W150",
    "N63W153",
    "N63W156",
    "N63W159",
    "N63W162",
    "N63W165",
    "N63W168",
    "N63W171",
    "N63W174",
    "N63W177",
    "N63W180",
    "N66E009",
    "N66E012",
    "N66E015",
    "N66E018",
    "N66E021",
    "N66E024",
    "N66E027",
    "N66E030",
    "N66E033",
    "N66E036",
    "N66E039",
    "N66E042",
    "N66E045",
    "N66E048",
    "N66E051",
    "N66E054",
    "N66E057",
    "N66E060",
    "N66E063",
    "N66E066",
    "N66E069",
    "N66E072",
    "N66E075",
    "N66E078",
    "N66E081",
    "N66E084",
    "N66E087",
    "N66E090",
    "N66E093",
    "N66E096",
    "N66E099",
    "N66E102",
    "N66E105",
    "N66E108",
    "N66E111",
    "N66E114",
    "N66E117",
    "N66E120",
    "N66E123",
    "N66E126",
    "N66E129",
    "N66E132",
    "N66E135",
    "N66E138",
    "N66E141",
    "N66E144",
    "N66E147",
    "N66E150",
    "N66E153",
    "N66E156",
    "N66E159",
    "N66E162",
    "N66E165",
    "N66E168",
    "N66E171",
    "N66E174",
    "N66E177",
    "N66W015",
    "N66W018",
    "N66W021",
    "N66W024",
    "N66W027",
    "N66W030",
    "N66W033",
    "N66W036",
    "N66W039",
    "N66W042",
    "N66W045",
    "N66W048",
    "N66W051",
    "N66W054",
    "N66W057",
    "N66W063",
    "N66W066",
    "N66W069",
    "N66W072",
    "N66W075",
    "N66W078",
    "N66W081",
    "N66W084",
    "N66W087",
    "N66W090",
    "N66W093",
    "N66W096",
    "N66W099",
    "N66W102",
    "N66W105",
    "N66W108",
    "N66W111",
    "N66W114",
    "N66W117",
    "N66W120",
    "N66W123",
    "N66W126",
    "N66W129",
    "N66W132",
    "N66W135",
    "N66W138",
    "N66W141",
    "N66W144",
    "N66W147",
    "N66W150",
    "N66W153",
    "N66W156",
    "N66W159",
    "N66W162",
    "N66W165",
    "N66W168",
    "N66W171",
    "N66W174",
    "N66W177",
    "N66W180",
    "N69E012",
    "N69E015",
    "N69E018",
    "N69E021",
    "N69E024",
    "N69E027",
    "N69E030",
    "N69E033",
    "N69E036",
    "N69E048",
    "N69E051",
    "N69E054",
    "N69E057",
    "N69E060",
    "N69E063",
    "N69E066",
    "N69E069",
    "N69E072",
    "N69E075",
    "N69E078",
    "N69E081",
    "N69E084",
    "N69E087",
    "N69E090",
    "N69E093",
    "N69E096",
    "N69E099",
    "N69E102",
    "N69E105",
    "N69E108",
    "N69E111",
    "N69E114",
    "N69E117",
    "N69E120",
    "N69E123",
    "N69E126",
    "N69E129",
    "N69E132",
    "N69E135",
    "N69E138",
    "N69E141",
    "N69E144",
    "N69E147",
    "N69E150",
    "N69E153",
    "N69E156",
    "N69E159",
    "N69E162",
    "N69E165",
    "N69E168",
    "N69E171",
    "N69E174",
    "N69E177",
    "N69W009",
    "N69W012",
    "N69W024",
    "N69W027",
    "N69W030",
    "N69W033",
    "N69W036",
    "N69W039",
    "N69W042",
    "N69W045",
    "N69W048",
    "N69W051",
    "N69W054",
    "N69W057",
    "N69W069",
    "N69W072",
    "N69W075",
    "N69W078",
    "N69W081",
    "N69W084",
    "N69W087",
    "N69W090",
    "N69W093",
    "N69W096",
    "N69W099",
    "N69W102",
    "N69W105",
    "N69W108",
    "N69W111",
    "N69W114",
    "N69W117",
    "N69W120",
    "N69W123",
    "N69W126",
    "N69W129",
    "N69W132",
    "N69W135",
    "N69W138",
    "N69W141",
    "N69W144",
    "N69W147",
    "N69W150",
    "N69W153",
    "N69W156",
    "N69W159",
    "N69W162",
    "N69W165",
    "N69W177",
    "N69W180",
    "N72E018",
    "N72E051",
    "N72E054",
    "N72E057",
    "N72E060",
    "N72E066",
    "N72E069",
    "N72E072",
    "N72E075",
    "N72E078",
    "N72E081",
    "N72E084",
    "N72E087",
    "N72E090",
    "N72E093",
    "N72E096",
    "N72E099",
    "N72E102",
    "N72E105",
    "N72E108",
    "N72E111",
    "N72E114",
    "N72E117",
    "N72E120",
    "N72E123",
    "N72E126",
    "N72E129",
    "N72E132",
    "N72E135",
    "N72E138",
    "N72E141",
    "N72E144",
    "N72E147",
    "N72E150",
    "N72W018",
    "N72W021",
    "N72W024",
    "N72W027",
    "N72W030",
    "N72W033",
    "N72W036",
    "N72W039",
    "N72W042",
    "N72W045",
    "N72W048",
    "N72W051",
    "N72W054",
    "N72W057",
    "N72W060",
    "N72W075",
    "N72W078",
    "N72W081",
    "N72W084",
    "N72W087",
    "N72W090",
    "N72W093",
    "N72W096",
    "N72W099",
    "N72W102",
    "N72W105",
    "N72W108",
    "N72W111",
    "N72W114",
    "N72W117",
    "N72W120",
    "N72W123",
    "N72W126",
    "N72W129",
    "N75E012",
    "N75E015",
    "N75E018",
    "N75E021",
    "N75E024",
    "N75E054",
    "N75E057",
    "N75E060",
    "N75E063",
    "N75E066",
    "N75E069",
    "N75E081",
    "N75E084",
    "N75E087",
    "N75E090",
    "N75E093",
    "N75E096",
    "N75E099",
    "N75E102",
    "N75E105",
    "N75E108",
    "N75E111",
    "N75E114",
    "N75E135",
    "N75E138",
    "N75E141",
    "N75E144",
    "N75E147",
    "N75E150",
    "N75E153",
    "N75E156",
    "N75W018",
    "N75W021",
    "N75W024",
    "N75W027",
    "N75W030",
    "N75W033",
    "N75W036",
    "N75W039",
    "N75W042",
    "N75W045",
    "N75W048",
    "N75W051",
    "N75W054",
    "N75W057",
    "N75W060",
    "N75W063",
    "N75W066",
    "N75W069",
    "N75W072",
    "N75W075",
    "N75W078",
    "N75W081",
    "N75W084",
    "N75W087",
    "N75W090",
    "N75W093",
    "N75W096",
    "N75W099",
    "N75W102",
    "N75W105",
    "N75W108",
    "N75W111",
    "N75W114",
    "N75W117",
    "N75W120",
    "N75W123",
    "N75W126",
    "N78E009",
    "N78E012",
    "N78E015",
    "N78E018",
    "N78E021",
    "N78E024",
    "N78E027",
    "N78E030",
    "N78E033",
    "N78E036",
    "N78E042",
    "N78E045",
    "N78E048",
    "N78E051",
    "N78E054",
    "N78E057",
    "N78E060",
    "N78E063",
    "N78E075",
    "N78E078",
    "N78E090",
    "N78E093",
    "N78E096",
    "N78E099",
    "N78E102",
    "N78E105",
    "N78E108",
    "N78W015",
    "N78W018",
    "N78W021",
    "N78W024",
    "N78W027",
    "N78W030",
    "N78W033",
    "N78W036",
    "N78W039",
    "N78W042",
    "N78W045",
    "N78W048",
    "N78W051",
    "N78W054",
    "N78W057",
    "N78W060",
    "N78W063",
    "N78W066",
    "N78W069",
    "N78W072",
    "N78W075",
    "N78W078",
    "N78W081",
    "N78W084",
    "N78W087",
    "N78W090",
    "N78W093",
    "N78W096",
    "N78W099",
    "N78W102",
    "N78W105",
    "N78W108",
    "N78W111",
    "N78W114",
    "N78W117",
    "N81E048",
    "N81E051",
    "N81E054",
    "N81E057",
    "N81E060",
    "N81E063",
    "N81E078",
    "N81E087",
    "N81E090",
    "N81E093",
    "N81E096",
    "N81W012",
    "N81W015",
    "N81W018",
    "N81W021",
    "N81W024",
    "N81W027",
    "N81W030",
    "N81W033",
    "N81W036",
    "N81W039",
    "N81W042",
    "N81W045",
    "N81W048",
    "N81W051",
    "N81W054",
    "N81W057",
    "N81W060",
    "N81W063",
    "N81W066",
    "N81W069",
    "N81W072",
    "N81W075",
    "N81W078",
    "N81W081",
    "N81W084",
    "N81W087",
    "N81W090",
    "N81W093",
    "N81W096",
    "S03E006",
    "S03E009",
    "S03E012",
    "S03E015",
    "S03E018",
    "S03E021",
    "S03E024",
    "S03E027",
    "S03E030",
    "S03E033",
    "S03E036",
    "S03E039",
    "S03E042",
    "S03E072",
    "S03E096",
    "S03E099",
    "S03E102",
    "S03E105",
    "S03E108",
    "S03E111",
    "S03E114",
    "S03E117",
    "S03E120",
    "S03E123",
    "S03E126",
    "S03E129",
    "S03E132",
    "S03E135",
    "S03E138",
    "S03E141",
    "S03E144",
    "S03E147",
    "S03E150",
    "S03E165",
    "S03E174",
    "S03W042",
    "S03W045",
    "S03W048",
    "S03W051",
    "S03W054",
    "S03W057",
    "S03W060",
    "S03W063",
    "S03W066",
    "S03W069",
    "S03W072",
    "S03W075",
    "S03W078",
    "S03W081",
    "S03W084",
    "S03W090",
    "S03W093",
    "S03W162",
    "S06E009",
    "S06E012",
    "S06E015",
    "S06E018",
    "S06E021",
    "S06E024",
    "S06E027",
    "S06E030",
    "S06E033",
    "S06E036",
    "S06E039",
    "S06E051",
    "S06E054",
    "S06E069",
    "S06E072",
    "S06E099",
    "S06E102",
    "S06E105",
    "S06E108",
    "S06E111",
    "S06E114",
    "S06E117",
    "S06E120",
    "S06E123",
    "S06E126",
    "S06E129",
    "S06E132",
    "S06E135",
    "S06E138",
    "S06E141",
    "S06E144",
    "S06E147",
    "S06E150",
    "S06E153",
    "S06E156",
    "S06E159",
    "S06E174",
    "S06W033",
    "S06W036",
    "S06W039",
    "S06W042",
    "S06W045",
    "S06W048",
    "S06W051",
    "S06W054",
    "S06W057",
    "S06W060",
    "S06W063",
    "S06W066",
    "S06W069",
    "S06W072",
    "S06W075",
    "S06W078",
    "S06W081",
    "S06W084",
    "S06W156",
    "S06W159",
    "S09E012",
    "S09E015",
    "S09E018",
    "S09E021",
    "S09E024",
    "S09E027",
    "S09E030",
    "S09E033",
    "S09E036",
    "S09E039",
    "S09E069",
    "S09E072",
    "S09E105",
    "S09E108",
    "S09E111",
    "S09E114",
    "S09E117",
    "S09E120",
    "S09E123",
    "S09E126",
    "S09E129",
    "S09E132",
    "S09E135",
    "S09E138",
    "S09E141",
    "S09E144",
    "S09E147",
    "S09E150",
    "S09E153",
    "S09E156",
    "S09E159",
    "S09E162",
    "S09E174",
    "S09E177",
    "S09W015",
    "S09W036",
    "S09W039",
    "S09W042",
    "S09W045",
    "S09W048",
    "S09W051",
    "S09W054",
    "S09W057",
    "S09W060",
    "S09W063",
    "S09W066",
    "S09W069",
    "S09W072",
    "S09W075",
    "S09W078",
    "S09W081",
    "S09W084",
    "S09W141",
    "S09W159",
    "S12E012",
    "S12E015",
    "S12E018",
    "S12E021",
    "S12E024",
    "S12E027",
    "S12E030",
    "S12E033",
    "S12E036",
    "S12E039",
    "S12E042",
    "S12E045",
    "S12E048",
    "S12E051",
    "S12E105",
    "S12E114",
    "S12E117",
    "S12E120",
    "S12E123",
    "S12E126",
    "S12E129",
    "S12E132",
    "S12E135",
    "S12E138",
    "S12E141",
    "S12E144",
    "S12E147",
    "S12E150",
    "S12E153",
    "S12E156",
    "S12E159",
    "S12E162",
    "S12E165",
    "S12E177",
    "S12W036",
    "S12W039",
    "S12W042",
    "S12W045",
    "S12W048",
    "S12W051",
    "S12W054",
    "S12W057",
    "S12W060",
    "S12W063",
    "S12W066",
    "S12W069",
    "S12W072",
    "S12W075",
    "S12W078",
    "S12W081",
    "S12W141",
    "S12W153",
    "S12W159",
    "S15E012",
    "S15E015",
    "S15E018",
    "S15E021",
    "S15E024",
    "S15E027",
    "S15E030",
    "S15E033",
    "S15E036",
    "S15E039",
    "S15E042",
    "S15E045",
    "S15E048",
    "S15E120",
    "S15E123",
    "S15E126",
    "S15E129",
    "S15E132",
    "S15E135",
    "S15E141",
    "S15E144",
    "S15E165",
    "S15E168",
    "S15W039",
    "S15W042",
    "S15W045",
    "S15W048",
    "S15W051",
    "S15W054",
    "S15W057",
    "S15W060",
    "S15W063",
    "S15W066",
    "S15W069",
    "S15W072",
    "S15W075",
    "S15W078",
    "S15W141",
    "S15W144",
    "S15W147",
    "S15W150",
    "S15W171",
    "S15W174",
    "S15W177",
    "S15W180",
    "S18E009",
    "S18E012",
    "S18E015",
    "S18E018",
    "S18E021",
    "S18E024",
    "S18E027",
    "S18E030",
    "S18E033",
    "S18E036",
    "S18E039",
    "S18E042",
    "S18E045",
    "S18E048",
    "S18E054",
    "S18E117",
    "S18E120",
    "S18E123",
    "S18E126",
    "S18E129",
    "S18E132",
    "S18E135",
    "S18E138",
    "S18E141",
    "S18E144",
    "S18E147",
    "S18E150",
    "S18E162",
    "S18E165",
    "S18E168",
    "S18E174",
    "S18E177",
    "S18W006",
    "S18W039",
    "S18W042",
    "S18W045",
    "S18W048",
    "S18W051",
    "S18W054",
    "S18W057",
    "S18W060",
    "S18W063",
    "S18W066",
    "S18W069",
    "S18W072",
    "S18W075",
    "S18W078",
    "S18W141",
    "S18W144",
    "S18W147",
    "S18W150",
    "S18W153",
    "S18W156",
    "S18W174",
    "S18W177",
    "S18W180",
    "S21E009",
    "S21E012",
    "S21E015",
    "S21E018",
    "S21E021",
    "S21E024",
    "S21E027",
    "S21E030",
    "S21E033",
    "S21E036",
    "S21E042",
    "S21E045",
    "S21E048",
    "S21E054",
    "S21E057",
    "S21E063",
    "S21E114",
    "S21E117",
    "S21E120",
    "S21E123",
    "S21E126",
    "S21E129",
    "S21E132",
    "S21E135",
    "S21E138",
    "S21E141",
    "S21E144",
    "S21E147",
    "S21E150",
    "S21E156",
    "S21E159",
    "S21E162",
    "S21E165",
    "S21E168",
    "S21E177",
    "S21W039",
    "S21W042",
    "S21W045",
    "S21W048",
    "S21W051",
    "S21W054",
    "S21W057",
    "S21W060",
    "S21W063",
    "S21W066",
    "S21W069",
    "S21W072",
    "S21W138",
    "S21W141",
    "S21W144",
    "S21W147",
    "S21W159",
    "S21W162",
    "S21W171",
    "S21W174",
    "S21W177",
    "S21W180",
    "S24E012",
    "S24E015",
    "S24E018",
    "S24E021",
    "S24E024",
    "S24E027",
    "S24E030",
    "S24E033",
    "S24E039",
    "S24E042",
    "S24E045",
    "S24E048",
    "S24E054",
    "S24E111",
    "S24E114",
    "S24E117",
    "S24E120",
    "S24E123",
    "S24E126",
    "S24E129",
    "S24E132",
    "S24E135",
    "S24E138",
    "S24E141",
    "S24E144",
    "S24E147",
    "S24E150",
    "S24E153",
    "S24E162",
    "S24E165",
    "S24E168",
    "S24E171",
    "S24W042",
    "S24W045",
    "S24W048",
    "S24W051",
    "S24W054",
    "S24W057",
    "S24W060",
    "S24W063",
    "S24W066",
    "S24W069",
    "S24W072",
    "S24W132",
    "S24W135",
    "S24W138",
    "S24W141",
    "S24W150",
    "S24W153",
    "S24W156",
    "S24W159",
    "S24W162",
    "S24W177",
    "S24W180",
    "S27E012",
    "S27E015",
    "S27E018",
    "S27E021",
    "S27E024",
    "S27E027",
    "S27E030",
    "S27E033",
    "S27E042",
    "S27E045",
    "S27E111",
    "S27E114",
    "S27E117",
    "S27E120",
    "S27E123",
    "S27E126",
    "S27E129",
    "S27E132",
    "S27E135",
    "S27E138",
    "S27E141",
    "S27E144",
    "S27E147",
    "S27E150",
    "S27E153",
    "S27W048",
    "S27W051",
    "S27W054",
    "S27W057",
    "S27W060",
    "S27W063",
    "S27W066",
    "S27W069",
    "S27W072",
    "S27W126",
    "S27W129",
    "S27W132",
    "S30E015",
    "S30E018",
    "S30E021",
    "S30E024",
    "S30E027",
    "S30E030",
    "S30E111",
    "S30E114",
    "S30E117",
    "S30E120",
    "S30E123",
    "S30E126",
    "S30E129",
    "S30E132",
    "S30E135",
    "S30E138",
    "S30E141",
    "S30E144",
    "S30E147",
    "S30E150",
    "S30E153",
    "S30W051",
    "S30W054",
    "S30W057",
    "S30W060",
    "S30W063",
    "S30W066",
    "S30W069",
    "S30W072",
    "S30W111",
    "S30W144",
    "S30W147",
    "S33E015",
    "S33E018",
    "S33E021",
    "S33E024",
    "S33E027",
    "S33E030",
    "S33E114",
    "S33E117",
    "S33E120",
    "S33E123",
    "S33E126",
    "S33E129",
    "S33E132",
    "S33E135",
    "S33E138",
    "S33E141",
    "S33E144",
    "S33E147",
    "S33E150",
    "S33E153",
    "S33W051",
    "S33W054",
    "S33W057",
    "S33W060",
    "S33W063",
    "S33W066",
    "S33W069",
    "S33W072",
    "S36E015",
    "S36E018",
    "S36E021",
    "S36E024",
    "S36E027",
    "S36E114",
    "S36E117",
    "S36E120",
    "S36E123",
    "S36E132",
    "S36E135",
    "S36E138",
    "S36E141",
    "S36E144",
    "S36E147",
    "S36E150",
    "S36E171",
    "S36E174",
    "S36W054",
    "S36W057",
    "S36W060",
    "S36W063",
    "S36W066",
    "S36W069",
    "S36W072",
    "S36W075",
    "S36W081",
    "S39E135",
    "S39E138",
    "S39E141",
    "S39E144",
    "S39E147",
    "S39E150",
    "S39E171",
    "S39E174",
    "S39E177",
    "S39W015",
    "S39W057",
    "S39W060",
    "S39W063",
    "S39W066",
    "S39W069",
    "S39W072",
    "S39W075",
    "S42E141",
    "S42E144",
    "S42E147",
    "S42E171",
    "S42E174",
    "S42E177",
    "S42W012",
    "S42W063",
    "S42W066",
    "S42W069",
    "S42W072",
    "S42W075",
    "S45E144",
    "S45E147",
    "S45E165",
    "S45E168",
    "S45E171",
    "S45E174",
    "S45W066",
    "S45W069",
    "S45W072",
    "S45W075",
    "S45W078",
    "S45W177",
    "S45W180",
    "S48E036",
    "S48E048",
    "S48E051",
    "S48E165",
    "S48E168",
    "S48E171",
    "S48W066",
    "S48W069",
    "S48W072",
    "S48W075",
    "S48W078",
    "S51E066",
    "S51E069",
    "S51E165",
    "S51W063",
    "S51W066",
    "S51W069",
    "S51W072",
    "S51W075",
    "S51W078",
    "S54E072",
    "S54E165",
    "S54E168",
    "S54W039",
    "S54W060",
    "S54W063",
    "S54W069",
    "S54W072",
    "S54W075",
    "S54W078",
    "S57E156",
    "S57E159",
    "S57W027",
    "S57W030",
    "S57W036",
    "S57W039",
    "S57W066",
    "S57W069",
    "S57W072",
    "S57W075",
    "S60W027",
    "S60W030",
}


def _s3_tile_urls(xmin: float, ymin: float, xmax: float, ymax: float) -> list[str]:
    """Return S3 URLs for all 3°×3° tiles that overlap the bounding box.

    Args:
        xmin: Minimum x-coordinate (longitude).
        ymin: Minimum y-coordinate (latitude).
        xmax: Maximum x-coordinate (longitude).
        ymax: Maximum y-coordinate (latitude).

    Returns:
        List of S3 URLs for all tiles covering the bounding box.
    """
    lat_start = math.floor(ymin / _TILE_SIZE_DEG) * _TILE_SIZE_DEG
    lon_start = math.floor(xmin / _TILE_SIZE_DEG) * _TILE_SIZE_DEG
    urls: list[str] = []
    lat = lat_start
    while lat < ymax:
        lon = lon_start
        while lon < xmax:
            NS = "N" if lat >= 0 else "S"
            EW = "E" if lon >= 0 else "W"
            TILE = f"{NS}{abs(lat):02.0f}{EW}{abs(lon):03.0f}"
            if TILE in AVAILABLE_TILES:
                filename = f"ESA_WorldCover_10m_2021_v200_{TILE}_Map.tif"
                urls.append(f"s3://{_S3_BUCKET}/{_S3_TILE_PATH}/{filename}")
            lon += _TILE_SIZE_DEG
        lat += _TILE_SIZE_DEG
    return urls


class ESAWorldCover(Adapter):
    """Adapter for ESA WorldCover datasets using direct AWS S3 access."""

    def __init__(self, *args: Any, **kwargs: Any) -> None:
        """Initialize the ESA WorldCover adapter.

        Args:
            *args: Positional arguments to pass to the Adapter constructor.
            **kwargs: Keyword arguments to pass to the Adapter constructor.
        """
        super().__init__(*args, **kwargs)

    def fetch(self, *args: Any, **kwargs: Any) -> ESAWorldCover:
        """No pre-fetching required; tiles are read directly from AWS S3 in read().

        Args:
            *args: Ignored.
            **kwargs: Ignored.

        Returns:
            The ESAWorldCover adapter instance.
        """
        return self

    def read(
        self,
        xmin: float,
        ymin: float,
        xmax: float,
        ymax: float,
    ) -> xr.DataArray:
        """Read ESA WorldCover data for the specified bounding box from AWS S3.

        Args:
            xmin: Minimum x-coordinate (longitude).
            ymin: Minimum y-coordinate (latitude).
            xmax: Maximum x-coordinate (longitude).
            ymax: Maximum y-coordinate (latitude).

        Returns:
            xarray.DataArray: The ESA WorldCover data for the specified bounding box.

        Raises:
            ValueError: If no tiles are found for the specified bounding box.
        """
        tile_urls = _s3_tile_urls(xmin, ymin, xmax, ymax)
        if not tile_urls:
            raise ValueError(
                f"No ESA WorldCover tiles found for bbox ({xmin}, {ymin}, {xmax}, {ymax})."
            )

        # GDAL config locally so it does not affect other S3 operations
        with rasterio.Env(AWS_NO_SIGN_REQUEST="YES", AWS_DEFAULT_REGION=_S3_REGION):
            arrays: list[xr.DataArray] = []
            for url in tile_urls:
                # Convert s3:// URL to GDAL /vsis3/ path
                vsi_path = "/vsis3/" + url[len("s3://") :]
                da = rioxarray.open_rasterio(vsi_path, chunks={"x": 3000, "y": 3000})
                assert isinstance(da, xr.DataArray), (
                    f"Expected DataArray, got {type(da)}"
                )
                arrays.append(da.sel(band=1))

            assert len(arrays) > 0, (
                f"No ESA WorldCover S3 tiles found for bbox ({xmin}, {ymin}, {xmax}, {ymax})."
            )

            merged = merge_arrays(arrays) if len(arrays) > 1 else arrays[0]
            merged = merged.sel(
                x=slice(xmin, xmax),
                y=slice(ymax, ymin),
            )

        return merged
